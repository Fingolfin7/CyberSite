{% extends 'core/base.html'%}
{% load crispy_forms_tags %}
{% load static %}

{% block jgs_includes %}
    <script src= "https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script> <!-- for jquery ui and autocomplete-->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"> </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
    <script src = "{% static 'core/js/issues.js' %}" type="text/javascript"></script>
    <script src = "{% static 'core/js/search.js' %}" type="text/javascript"></script>
    <link rel="stylesheet" href="{% static 'core/css/autocomplete.css' %}">
{% endblock %}

{% block content %}
  <form class="card form"  method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="flex-row">
            <span class="left"><h3><u>{{ title }}</u></h3></span>
            <span class="flex-row width-20" id="issues-corner-buttons">
                <button type="submit" class="dodgerblue button no-border" name="save">
                    <i class="material-icons">save</i>
                    Save
                </button>
            </span>
        </div>
        <div id="issues-div">
          <div>
            {% for hidden in form.hidden_fields %} <!--to fix the issue with the 'id' field is required-->
                {{ hidden }}
            {% endfor %}

            <div class="flex-row">
                <span class="left width-90">
                  {{ form.name }}
                  {{ form.name.errors }}
                  {{ form.non_field_errors }}
                </span>
              </div>
              <div class="pad-top pd08">
                  <div class="even-columns pad-bottom">
                      <span>
                          {{ form.summary }}
                          {{ form.summary.errors }}
                      </span>
                      <span>
                        <div class="pad-bottom width-90">
                            {{ form.severity }}
                            {{ form.severity.errors }}
                        </div>
                      </span>
                  </div>

                  <div class="even-columns pad-bottom">
                      <span>
                          {{ form.affected_hosts }}
                          {{ form.affected_hosts.errors }}
                      </span>
                      <span>
                          {{ form.description }}
                          {{ form.description.errors }}
                      </span>
                      <span>
                          {{ form.impact }}
                          {{ form.impact.errors }}
                      </span>
                      <span>
                          {{ form.solution }}
                          {{ form.solution.errors }}
                      </span>
                      <span>
                        <div class="pad-bottom pad-right pd1 width-90">
                            {{ form.reference }}
                            {{ form.reference.errors }}
                        </div>
                        <div>
                            {{ form.cvss_rating }}
                            {{ form.cvss_rating.errors }}
                        </div>
                      </span>
                  </div>

                  <div class="pad-bottom flex-columns width-90" id="preview-{{ form.proof_screenshot.id_for_label }}">
                      {% if form.instance.proof_screenshot %}
                          <img src="{{form.instance.proof_screenshot.url}}"
                          style="max-height: 100px;
                          border: 2px solid lightgrey;
                          margin-right: 2%;"/>
                      {% endif %}
                  </div>

                  <div class="top-border">
                    <label class="pad-top" for="{{ form.proof_screenshot.id_for_label }}">
                        <i class="material-icons round-upload">attach_file</i>
                        {{ form.proof_screenshot }}
                    </label>
                  </div>
              </div>
            </div>
        </div>
  </form>{% endblock %}